(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","Slick","nf.Common","nf.UniversalCapture","nf.Dialog","nf.Storage","nf.Client","nf.ErrorHandler","nf.ProcessGroup","nf.ProcessGroupConfiguration","nf.Settings","nf.ParameterContexts","lodash-core"],function(i,f,g,k,h,j,o,l,c,d,e,m,n){b(i,f,g,k,h,j,o,l,c,d,e,m,n)})}else{if(typeof exports==="object"&&typeof module==="object"){b(require("jquery"),require("Slick"),require("nf.Common"),require("nf.UniversalCapture"),require("nf.Dialog"),require("nf.Storage"),require("nf.Client"),require("nf.ErrorHandler"),require("nf.ProcessGroup"),require("nf.ProcessGroupConfiguration"),require("nf.Settings"),recuire("nf.ParameterContexts"),require("lodash-core"))}else{b(a.$,a.Slick,a.nf.Common,a.nf.UniversalCapture,a.nf.Dialog,a.nf.Storage,a.nf.Client,a.nf.ErrorHandler,a.nf.ProcessGroup,a.nf.ProcessGroupConfiguration,a.nf.Settings,a.nf.ParameterContexts,a._)}}}(this,function(t,a,C,b,h,n,e,c,q,w,z,G,I){var E=null;var g=212;var H=212;var B=100;var J="<div>Expression Language (EL) supported</div>";var o='<div>After beginning with the start delimiter <span class="hint-pattern">${</span> use the keystroke <span class="hint-keystroke">control+space</span> to see a list of available functions.</div>';var k="<div>Expression Language (EL) not supported</div>";var d="<div>Parameters (PARAM) supported</div>";var i='<div>After beginning with the start delimiter <span class="hint-pattern">#{</span> use the keystroke <span class="hint-keystroke">control+space</span> to see a list of available parameters.</div>';var j="<div>Parameters (PARAM) not supported</div>";var l=function(K){if(C.isDefinedAndNotNull(K)){return K.startsWith("#{")&&K.endsWith("}")}return false};var r=function(L){var K=/#{[a-zA-Z0-9-_. ]+}/;return K.test(L)};var F=function(L,N){var O=t("<div></div>");var M=t("<div></div>").addClass("mode-hint-tip-title-container").appendTo(O);if(N){t("<div></div>").addClass("fa fa-check").appendTo(M);t(L?J:d).addClass("mode-supported").appendTo(M);var K=t("<div></div>").addClass("mode-hint-tip-description-container").appendTo(O);t(L?o:i).appendTo(K)}else{t("<div></div>").addClass("fa fa-ban").appendTo(M);t(L?k:j).addClass("mode-unsupported").appendTo(M)}return O};var f=function(K){return function(Q){var T=this;var S="";var M;var P;var N;var L;var O;var R;this.init=function(){var U=t("body");var Y=t(Q.grid.getContainerNode());var ah=Y.data("descriptors");P=ah[Q.item.property];var Z=K(P);var ab=C.isSensitiveProperty(P);M=Q.item[Q.column.field];L=t("<div></div>").addClass("slickgrid-nf-editor").css({"z-index":14000,position:"absolute",padding:"10px 20px",overflow:"hidden","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",cursor:"move",transform:"translate3d(0px, 0px, 0px)"}).draggable({cancel:".button, .mode-hint-element, .nf-editor, .string-check-container > *",containment:"parent"}).appendTo(U);R=t("<div></div>").addClass("mode-hint-tip").appendTo(U);var aa=Z.supportsEl();var ag=Z.supportsParameterReference();R.append(F(true,aa));R.append(F(false,ag));var X=t("<div></div>").addClass("mode-hint-container").appendTo(L);var ac=t("<div></div>").addClass("mode-hint-element").on("mouseenter",function(){var al=L.position();var ak=al.top-R.outerHeight()+2;var aj=al.left+L.outerWidth()-R.outerWidth()+5;R.css({top:ak+"px",left:aj+"px"});R.show()}).on("mouseleave",function(){R.hide()}).appendTo(X);var ae=t("<div></div>").addClass("mode-hint").appendTo(ac);t("<div>EL</div>").appendTo(ae);t("<div></div>").addClass("mode-hint-value fa").addClass(aa?"fa-check":"fa-ban").appendTo(ae);var af=t("<div></div>").addClass("mode-hint").appendTo(ac);t("<div>PARAM</div>").appendTo(af);t("<div></div>").addClass("mode-hint-value fa").addClass(ag?"fa-check":"fa-ban").appendTo(af);var W=Math.max(Q.position.width,H);O=t("<div></div>").addClass("nf-editor").appendTo(L).nfeditor({languageMode:Z,width:W,minWidth:H,minHeight:B,resizable:true,sensitive:ab,escape:function(){T.cancel()},enter:function(){T.save()}});var V=t('<div class="string-check-container">');V.appendTo(L);N=t('<div class="nf-checkbox string-check"/>').on("change",function(ak,aj){if(aj.isChecked){O.nfeditor("setValue","");O.nfeditor("setReadOnly","nocursor")}else{O.nfeditor("setValue",S);O.nfeditor("setReadOnly",false)}}).appendTo(V);t('<span class="string-check-label nf-checkbox-label">&nbsp;Set empty string</span>').appendTo(V);var ad=t('<div class="button">Ok</div>').css({color:"#fff",background:"#728E9B"}).hover(function(){t(this).css("background","#004849")},function(){t(this).css("background","#728E9B")}).on("click",T.save);var ai=t('<div class="secondary-button">Cancel</div>').css({color:"#004849",background:"#E3E8EB"}).hover(function(){t(this).css("background","#C7D2D7")},function(){t(this).css("background","#E3E8EB")}).on("click",T.cancel);t("<div></div>").css({position:"relative",top:"10px",left:"20px",width:"212px",clear:"both","float":"right"}).append(ad).append(ai).append('<div class="clear"></div>').appendTo(L);T.position(Q.position);O.nfeditor("focus").nfeditor("selectAll")};this.save=function(){Q.commitChanges()};this.cancel=function(){O.nfeditor("setValue",S);Q.cancelChanges()};this.hide=function(){L.hide()};this.show=function(){L.show();O.nfeditor("refresh")};this.position=function(U){L.css({top:U.top-16,left:U.left-42})};this.destroy=function(){O.nfeditor("destroy");L.remove();R.remove()};this.focus=function(){O.nfeditor("focus")};this.loadValue=function(W){var X=false;var U=C.isSensitiveProperty(P);if(C.isDefinedAndNotNull(W[Q.column.field])){if(U){S=C.config.sensitiveText}else{S=W[Q.column.field];X=S===""}}var V;if(X){V="checkbox-checked";O.nfeditor("setReadOnly","nocursor")}else{V="checkbox-unchecked"}N.addClass(V);O.nfeditor("setValue",S).nfeditor("selectAll")};this.serializeValue=function(){var U=O.nfeditor("getValue");if(U===""){if(N.hasClass("checkbox-checked")){return""}if(C.isRequiredProperty(P)){if(C.isBlank(P.defaultValue)){return M}return P.defaultValue}return null}if(O.nfeditor("isModified")===false){return M}return U};this.applyValue=function(U,V){U[Q.column.field]=V};this.isValueChanged=function(){return T.serializeValue()!==M};this.validate=function(){return{valid:true,msg:null}};this.init()}};var s=function(K,L){return function(V){var Y={text:"Reference parameter...",value:undefined,optionClass:"unset"};var Q={text:"Loading parameters...",value:null,optionClass:"unset",disabled:true};var P={text:"Create new service...",value:undefined,optionClass:"unset"};var X=this;var O=[];var Z=[];var W=null;var N;var S;var U;var T;var M=true;var R;this.init=function(){var ab=t("body");var ae=t(V.grid.getContainerNode());var aj=ae.data("descriptors");T=aj[V.item.property];var al=ae.closest(".property-container");var ag=al.data("options");N=t('<div class="combo-editor"></div>').css({"z-index":1999,position:"absolute",padding:"10px 20px",overflow:"hidden","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",cursor:"move",transform:"translate3d(0px, 0px, 0px)"}).draggable({cancel:".button, .combo",containment:"parent"}).appendTo(ab);var ad=C.getAllowableValues(T);if(t.isArray(ad)){t.each(ad,function(an,ao){var am=ao.allowableValue;O.push({text:am.displayName,value:am.value,disabled:ao.canRead===false&&am.value!==V.item.previousValue,description:C.escapeHtml(am.description)})})}if(T.required===false){O.push({text:"No value",value:null,optionClass:"unset"})}if(K&&!C.isDefinedAndNotNull(T.identifiesControllerService)){O.push(Y)}if(O.length===0){O.push({text:"No value",value:null,optionClass:"unset",disabled:true})}if(C.isDefinedAndNotNull(T.identifiesControllerService)){O.push(P)}var af=V.position;var aa=t(window).height();var ai=aa-af.bottom-16;var ac=Math.max(af.width-16,g);S=t('<div class="value-combo combo"></div>').combo({options:O,maxHeight:ai,select:function(am){var an=function(){X.cancel();x(ae,V.grid,V.item,T.identifiesControllerService,T.identifiesControllerServiceBundle,ag)};if(K){if(C.isDefinedAndNotNull(U)){if(am===Y){U.show()}else{U.hide();if(am===P){an()}}}}else{if(am===P){an()}}}}).css({"margin-top":"10px","margin-bottom":"10px",width:ac+"px"}).appendTo(N);if(K){U=t('<div class="value-combo combo"></div>').combo({options:[Q],maxHeight:ai}).css({"margin-bottom":"10px",width:ac+"px"}).appendTo(N);R=new t.Deferred(function(am){L(T,function(an){var ao=I.sortBy(an,"name");ao.forEach(function(ap){Z.push({text:ap.name,value:"#{"+ap.name+"}",description:C.escapeHtml(ap.description)})});U.combo("destroy").combo({options:Z,maxHeight:ai});am.resolve();M=false})}).promise()}var ak=t('<div class="secondary-button">Cancel</div>').css({color:"#004849",background:"#E3E8EB"}).hover(function(){t(this).css("background","#C7D2D7")},function(){t(this).css("background","#E3E8EB")}).on("click",X.cancel);var ah=t('<div class="button">Ok</div>').css({color:"#fff",background:"#728E9B"}).hover(function(){t(this).css("background","#004849")},function(){t(this).css("background","#728E9B")}).on("click",X.save);t("<div></div>").css({position:"relative",top:"10px",left:"20px",width:"212px","float":"right"}).append(ah).append(ak).appendTo(N);X.position(af)};this.save=function(){V.commitChanges()};this.cancel=function(){V.cancelChanges()};this.hide=function(){N.hide()};this.show=function(){N.show()};this.position=function(aa){N.css({top:aa.top-24,left:aa.left-20})};this.destroy=function(){if(K){U.combo("destroy")}S.combo("destroy");N.remove();O.length=0;Z.length=0};this.focus=function(){};this.loadValue=function(ab){var ac;if(!C.isUndefined(ab.value)){ac=ab.value}else{if(C.isDefinedAndNotNull(T.defaultValue)){ac=T.defaultValue}}if(!C.isUndefined(ac)){W=ac;var aa=O.find(function(ae){return W===ae.value});if(!C.isUndefined(aa)){S.combo("setSelectedOption",aa)}else{if(K&&l(W)){S.combo("setSelectedOption",Y);var ad={value:W};if(M){R.then(function(){U.combo("setSelectedOption",ad)})}else{U.combo("setSelectedOption",ad)}}else{S.combo("setSelectedOption",O[0])}}}else{S.combo("setSelectedOption",O[0])}};this.serializeValue=function(){var ab=S.combo("getSelectedOption");var aa=ab.value;if(K&&I.isUndefined(aa)){ab=U.combo("getSelectedOption");if(ab===Q){aa=W}else{aa=ab.value}}return aa};this.applyValue=function(aa,ab){aa[V.column.field]=ab};this.isValueChanged=function(){var aa=X.serializeValue();return aa!==W};this.validate=function(){return{valid:true,msg:null}};this.init()}};var A=function(Y,ab,R,K){b.removeAllPropertyDetailDialogs();var X=Y.getData();var S=X.getItem(R);if(C.isDefinedAndNotNull(S.value)){var T=ab[S.property];if(!C.isSensitiveProperty(T)){var O=t(Y.getCellNode(R,K));var P=O.offset();var Q=t('<div class="property-detail"></div>').css({"z-index":1999,position:"absolute",padding:"10px 20px",overflow:"hidden","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",cursor:"move",transform:"translate3d(0px, 0px, 0px)",top:P.top-24,left:P.left-20}).appendTo("body");var L=C.getAllowableValues(T);if(t.isArray(L)){Q.draggable({cancel:".button, .combo",containment:"parent"});var M=[];t.each(L,function(ad,ae){var ac=ae.allowableValue;M.push({text:ac.displayName,value:ac.value,description:C.escapeHtml(ac.description),disabled:true})});if(M.length===0){M.push({text:"No value",value:null,optionClass:"unset",disabled:true})}var U=t(window).height();var Z=U-(P.top+O.height())-16;var aa=O.width()-16;t('<div class="value-combo combo"></div>').css({width:aa,"margin-top":"10px","margin-bottom":"10px"}).combo({options:M,maxHeight:Z,selectedOption:{value:S.value}}).appendTo(Q);t('<div class="button">Ok</div>').css({position:"relative",top:"10px",left:"20px"}).hover(function(){t(this).css("background","#004849")},function(){t(this).css("background","#728E9B")}).on("click",function(){Q.hide().remove()}).appendTo(Q)}else{var N=null;if(C.supportsEl(T)){Q.css({"z-index":1999,position:"absolute",padding:"10px 20px",overflow:"hidden","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",cursor:"move",transform:"translate3d(0px, 0px, 0px)",top:P.top-22,left:P.left-43}).draggable({cancel:"input, textarea, pre, .button, .nf-editor",containment:"parent"});N=t("<div></div>").addClass("nf-editor").appendTo(Q).nfeditor({languageMode:nf.nfel,width:O.width(),content:S.value,minWidth:175,minHeight:100,readOnly:true,resizable:true,escape:function(){W()}})}else{Q.css({"z-index":1999,position:"absolute",padding:"10px 20px",overflow:"hidden","border-radius":"2px","box-shadow":"rgba(0, 0, 0, 0.247059) 0px 2px 5px","background-color":"rgb(255, 255, 255)",cursor:"move",transform:"translate3d(0px, 0px, 0px)",top:P.top-26,left:P.left-20});t('<textarea hidefocus rows="5" readonly="readonly"/>').css({height:"80px",resize:"both",width:O.width()+"px",margin:"10px 0px","white-space":"pre"}).text(S.value).on("keydown",function(ac){if(ac.which===t.ui.keyCode.ESCAPE){W();ac.stopImmediatePropagation();ac.preventDefault()}}).appendTo(Q);Q.draggable({containment:"parent"})}var W=function(){if(N!==null){N.nfeditor("destroy")}Q.hide().remove()};var V=t('<div class="button">Ok</div>').css({position:"relative",top:"10px",left:"20px"}).hover(function(){t(this).css("background","#004849")},function(){t(this).css("background","#728E9B")}).on("click",function(){W()});t("<div></div>").append(V).append('<div class="clear"></div>').appendTo(Q)}}}};var x=function(K,M,N,O,L,P){t.ajax({type:"GET",url:"../nifi-api/flow/controller-service-types",data:{serviceType:O,serviceBundleGroup:L.group,serviceBundleArtifact:L.artifact,serviceBundleVersion:L.version},dataType:"json"}).done(function(R){var ah=K.data("descriptors");var Y=ah[N.property];var af=d3.map();var W=[];t.each(R.controllerServiceTypes,function(ai,aj){af.set(ai,aj);W.push({text:C.formatType(aj),value:ai,description:C.escapeHtml(aj.description)})});if(W.length===0){h.showOkDialog({headerText:"Controller Service",dialogContent:"No controller service types found that are applicable for this property."})}else{var ad='<div id="new-inline-controller-service-dialog" class="hidden dialog medium-dialog cancellable"><div class="dialog-content"><div><div class="setting-name">Requires Controller Service</div><div class="setting-field"><div class="new-inline-controller-service-requirement"></div></div></div><div><div class="setting-name">Compatible Controller Services</div><div class="setting-field"><div class="new-inline-controller-service-combo"></div></div></div><div><div class="setting-name">Controller Service Name</div><div class="setting-field"><input type="text" class="new-inline-controller-service-name"/></div></div><div><div class="setting-name">Bundle</div><div class="setting-field"><div class="new-inline-controller-service-bundle"></div></div></div><div><div class="setting-name">Tags</div><div class="setting-field"><div class="new-inline-controller-service-tags"></div></div></div><div><div class="setting-name">Description</div><div class="setting-field"><div class="new-inline-controller-service-description"></div></div></div></div></div>';var ac=t(ad).appendTo(P.dialogContainer);var S=ac.find("div.new-inline-controller-service-requirement");var Z=ac.find("div.new-inline-controller-service-combo");var ag=ac.find("input.new-inline-controller-service-name");var X=ac.find("div.new-inline-controller-service-bundle");var U=ac.find("div.new-inline-controller-service-tags");var ae=ac.find("div.new-inline-controller-service-description");var T=C.formatType({type:Y.identifiesControllerService,bundle:Y.identifiesControllerServiceBundle});var ab=C.formatBundle(Y.identifiesControllerServiceBundle);S.text(T+" from "+ab);W.sort(function(aj,ai){var ak=af.get(aj.value);var an=af.get(ai.value);var am=C.substringAfterLast(ak.type,".");var al=C.substringAfterLast(an.type,".");return am===al?-C.sortVersion(ak.bundle.version,an.bundle.version):am>al?1:-1});var Q=C.formatClassName(af.get(0));ag.val(Q);Z.combo({options:W,select:function(aj){var ai=af.get(aj.value);X.text(C.formatBundle(ai.bundle));U.text(ai.tags.join(", "));ae.text(ai.description);if(Q===ag.val().trim()){Q=C.formatClassName(ai);ag.val(Q)}}});ac.modal({headerText:"Add Controller Service",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Create",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){aa()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){V()}}}]});var aa=function(){var ak=Z.combo("getSelectedOption").value;var al=af.get(ak);var aj=ag.val();var ai={revision:e.getRevision({revision:{version:0,}}),disconnectedNodeAcknowledged:n.isDisconnectionAcknowledged(),component:{type:al.type,bundle:al.bundle}};if(aj.trim()!==""){ai.component.name=aj.trim()}var am="../nifi-api/controller/controller-services";if(C.isDefinedAndNotNull(E)){am="../nifi-api/process-groups/"+encodeURIComponent(E)+"/controller-services"}t.ajax({type:"POST",url:am,data:JSON.stringify(ai),dataType:"json",contentType:"application/json"}).done(function(an){P.descriptorDeferred(N.property).done(function(ar){var aq=ar.propertyDescriptor;var ao=K.data("descriptors");if(!C.isUndefined(ao)){ao[aq.name]=aq}var ap=M.getData();ap.updateItem(N.id,t.extend(N,{value:an.component.id}));ac.modal("hide")});if(typeof P.controllerServiceCreatedDeferred==="function"){P.controllerServiceCreatedDeferred(an)}}).fail(c.handleAjaxError)};var V=function(){ac.modal("hide")};ac.modal("show")}}).fail(c.handleAjaxError)};var m=function(S,T){var P=function(ad,ab,aa,X,V){var Z=30;var U=t("<div></div>");var W=t("<span/>").addClass("table-cell").text(aa).appendTo(U);if(V.type==="required"){W.addClass("required")}var ac=S.data("descriptors");var Y=ac[V.property];if(C.isDefinedAndNotNull(Y)){if(!C.isBlank(Y.description)||!C.isBlank(Y.defaultValue)||!C.isBlank(Y.supportsEl)){t('<div class="fa fa-question-circle" alt="Info" style="float: right;"></div>').appendTo(U);t('<span class="hidden property-descriptor-name"></span>').text(V.property).appendTo(U);Z=46}}W.width(X.width-Z).ellipsis();return U.html()};var Q=function(ae,ac,ab,X,U){var aa;if(C.isDefinedAndNotNull(ab)){var ad=S.data("descriptors");var Z=ad[U.property];if(C.isSensitiveProperty(Z)){aa='<span class="table-cell sensitive">Sensitive value set</span>'}else{var W=false;var V=C.getAllowableValues(Z);if(t.isArray(V)){t.each(V,function(af,ah){var ag=ah.allowableValue;if(ab===ag.value){ab=ag.displayName;W=true;return false}})}if(ab===""){aa='<span class="table-cell blank">Empty string set</span>'}else{if(!W&&C.isDefinedAndNotNull(Z.identifiesControllerService)){aa='<span class="table-cell blank">Incompatible Controller Service Configured</div>'}else{aa='<div class="table-cell value"><pre class="ellipsis">'+C.escapeHtml(ab)+"</pre></div>"}}}}else{aa='<span class="unset">No value set</span>'}var Y=t(aa);if(U.type==="required"){Y.addClass("required")}Y.find(".ellipsis").width(X.width-10).ellipsis();return t("<div/>").append(Y).html()};var K=[{id:"property",field:"displayName",name:"Property",sortable:false,resizable:true,rerenderOnResize:true,formatter:P},{id:"value",field:"value",name:"Value",sortable:false,resizable:true,cssClass:"pointer",rerenderOnResize:true,formatter:Q}];var O=function(ai,ae,ad,Y,W){var ah="";var ag=S.data("descriptors");var aa=ag[W.property];var V=C.isDefinedAndNotNull(aa.identifiesControllerService);var U=C.isDefinedAndNotNull(W.value);if(V&&U&&(T.supportsGoTo===true)){t.each(aa.allowableValues,function(aj,al){var ak=al.allowableValue;if(ak.value===W.value){ah+='<div class="pointer go-to-service fa fa-long-arrow-right" title="Go To"></div>';return false}})}var Z=r(W.value);var af=false;var X=false;if(I.isFunction(T.getParameterContext)){var ac=T.getParameterContext(E);var ab=I.get(ac,"permissions.canWrite",false);X=I.get(ac,"permissions.canRead",false);af=ab&&X}if(Z&&X){ah+='<div title="Go to parameter" class="goto-to-parameter pointer fa fa-long-arrow-right"></div>'}if(T.readOnly!==true){if(af&&!Z&&!V){ah+='<div title="Convert to parameter" class="convert-to-parameter pointer fa fa-level-up"></div>'}if(W.type==="userDefined"){ah+='<div title="Delete" class="delete-property pointer fa fa-trash"></div>'}}return ah};K.push({id:"actions",name:"&nbsp;",minWidth:20,width:20,formatter:O});var L={forceFitColumns:true,enableTextSelectionOnCells:true,enableCellNavigation:true,enableColumnReorder:false,editable:T.readOnly!==true,enableAddRow:false,autoEdit:false,rowHeight:24};var R=new a.Data.DataView({inlineFilters:false});R.setItems([]);R.setFilterArgs({searchString:"",property:"hidden"});R.setFilter(v);R.getItemMetadata=function(V){var Y=R.getItem(V);var X=S.data("descriptors");var U=X[Y.property];var aa=function(ac,ab,ad){ab(ac,E).done(function(ae){ad(ae)})};var W=typeof T.parameterDeferred==="function";if(C.isUndefinedOrNull(U)||C.supportsEl(U)){return{columns:{value:{editor:f(function(ab){if(W){nf.nfel.enableParameters();aa(ab,T.parameterDeferred,nf.nfel.setParameters)}else{nf.nfel.disableParameters()}return nf.nfel})}}}}else{var Z=C.getAllowableValues(U);if(t.isArray(Z)){return{columns:{value:{editor:s(W,function(ab,ac){if(W){aa(ab,T.parameterDeferred,ac)}})}}}}else{return{columns:{value:{editor:f(function(ab){if(W){nf.nfpr.enableParameters();aa(ab,T.parameterDeferred,nf.nfpr.setParameters)}else{nf.nfpr.disableParameters()}return nf.nfpr})}}}}}};var N=function(U){t.ajax({type:"GET",url:"../nifi-api/controller-services/"+encodeURIComponent(U.value),dataType:"json"}).done(function(V){var X=S.closest(".dialog");if(X.hasClass("modal")){X.modal("hide")}else{X.hide()}var W=V.component;t.Deferred(function(Y){if(C.isDefinedAndNotNull(W.parentGroupId)){q.enterGroup(W.parentGroupId).done(function(){if(t("#process-group-configuration").is(":visible")){w.loadConfiguration(W.parentGroupId).done(function(){Y.resolve()})}else{w.showConfiguration(W.parentGroupId).done(function(){Y.resolve()})}})}else{if(t("#settings").is(":visible")){z.loadSettings().done(function(){Y.resolve()})}else{z.showSettings().done(function(){Y.resolve()})}}}).done(function(){if(C.isDefinedAndNotNull(W.parentGroupId)){w.selectControllerService(U.value)}else{z.selectControllerService(U.value)}})}).fail(c.handleAjaxError)};var M=new a.Grid(S,R,K,L);M.setSelectionModel(new a.RowSelectionModel());M.onClick.subscribe(function(Y,aa){if(M.getColumns()[aa.cell].id==="value"){if(T.readOnly===true){var ae=S.data("descriptors");A(M,ae,aa.row,aa.cell)}else{M.gotoCell(aa.row,aa.cell,true)}Y.stopImmediatePropagation()}else{if(M.getColumns()[aa.cell].id==="actions"){var ad=R.getItem(aa.row);var Z=t(Y.target);if(Z.hasClass("delete-property")){R.updateItem(ad.id,t.extend(ad,{hidden:true}));Y.stopImmediatePropagation()}else{if(Z.hasClass("go-to-service")){if(T.readOnly===true){N(ad)}else{if(typeof T.goToServiceDeferred==="function"){T.goToServiceDeferred().done(function(){N(ad)})}}}else{if(Z.hasClass("convert-to-parameter")){var U;var af=false;if(I.isFunction(T.getParameterContext)){U=T.getParameterContext(E);var ab=I.get(U,"permissions.canWrite",false);var V=I.get(U,"permissions.canRead",false);af=ab&&V}if(T.readOnly!==true&&af){var ae=S.data("descriptors");var X=ae[ad.property];G.convertPropertyToParameter(ad,X,U.id).done(function(ai){var ah=I.extend({},ad,{previousValue:ad.value,value:"#{"+ai.name+"}"});R.updateItem(ad.id,ah)})}}else{if(Z.hasClass("goto-to-parameter")){var U;if(I.isFunction(T.getParameterContext)){U=T.getParameterContext(E);var V=I.get(U,"permissions.canRead",false);if(V&&!I.isNil(ad.value)){var W=/#{([a-zA-Z0-9-_. ]+)}/;var ag=ad.value.match(W);if(!I.isEmpty(ag)&&ag.length===2){var ac=ag[1];G.showParameterContext(U.id,null,ac)}}}}}}}}}});M.onKeyDown.subscribe(function(V,U){if(V.which===t.ui.keyCode.ESCAPE){var W=M.getEditorLock();if(W.isActive()){W.cancelCurrentEdit();V.stopImmediatePropagation();V.preventDefault()}}});if(T.readOnly!==true){M.onBeforeCellEditorDestroy.subscribe(function(V,U){setTimeout(function(){M.resizeCanvas()},50)})}R.onRowCountChanged.subscribe(function(V,U){M.updateRowCount();M.render()});R.onRowsChanged.subscribe(function(V,U){M.invalidateRows(U.rows);M.render()});S.data("gridInstance",M).on("mouseenter","div.slick-cell",function(ab){var V=t(this).find("div.fa-question-circle");if(V.length&&!V.data("qtip")){var Z=t(this).find("span.property-descriptor-name").text();var W=S.data("descriptors");var U=W[Z];var aa=S.data("history");var X=aa[Z];var Y=C.formatPropertyTooltip(U,X);if(C.isDefinedAndNotNull(Y)){V.qtip(t.extend({},C.config.tooltipConfig,{content:Y}))}}})};var p=function(M){var L=M.data("gridInstance");if(C.isDefinedAndNotNull(L)){var K=L.getEditController();K.commitCurrentEdit()}};var v=function(L,K){return L.hidden===false};var D=function(P,M,N,Q){P.data({descriptors:N,history:Q});var K=P.data("gridInstance");var O=K.getData();if(C.isDefinedAndNotNull(M)){O.beginUpdate();var L=0;t.each(M,function(S,U){var V=N[S];var T="userDefined";var R=S;if(C.isDefinedAndNotNull(V)){if(C.isRequiredProperty(V)){T="required"}else{if(C.isDynamicProperty(V)){T="userDefined"}else{T="optional"}}R=V.displayName;if(C.isNull(U)&&C.isDefinedAndNotNull(V.defaultValue)){U=V.defaultValue}}O.addItem({id:L++,hidden:false,property:S,displayName:R,previousValue:U,value:U,type:T})});O.endUpdate()}};var y=function(O){var L=O.data("options");if(L.readOnly===true){b.removeAllPropertyDetailDialogs()}else{if(C.isDefinedAndNotNull(L.dialogContainer)){t("#new-property-dialog").modal("hide")}}var N=O.find("div.property-table");N.removeData("descriptors history");C.cleanUpTooltips(N,"div.fa-question-circle");var K=N.data("gridInstance");var M=K.getData();M.setItems([])};var u={init:function(K){return this.each(function(){if(C.isDefinedAndNotNull(K)){var P=t(this);P.empty().unbind().addClass("property-container").data("options",K);var O=t('<div class="properties-header"></div>').appendTo(P);t('<div class="required-property-note">Required field</div>').appendTo(O);var S=t('<div class="property-table"></div>').appendTo(P);if(K.readOnly!==true&&C.isDefinedAndNotNull(K.dialogContainer)){var M='<div id="new-property-dialog" class="dialog cancellable small-dialog hidden"><div class="dialog-content"><div><div class="setting-name">Property name</div><div class="setting-field new-property-name-container"><input class="new-property-name" type="text"/></div></div></div></div>';var L=t(M).appendTo(K.dialogContainer);var N=L.find("input.new-property-name");L.modal({headerText:"Add Property",scrollableContentStyle:"scrollable",buttons:[{buttonText:"Ok",color:{base:"#728E9B",hover:"#004849",text:"#ffffff"},handler:{click:function(){R()}}},{buttonText:"Cancel",color:{base:"#E3E8EB",hover:"#C7D2D7",text:"#004849"},handler:{click:function(){T()}}}]});var R=function(){var U=t.trim(N.val());if(U!==""){var V=S.data("gridInstance");var X=V.getData();var W=null;t.each(X.getItems(),function(Z,aa){if(U===aa.property){W=aa;return false}});if(W===null){K.descriptorDeferred(U).done(function(Z){var ab=Z.propertyDescriptor;var aa=S.data("descriptors");if(!C.isUndefined(aa)){aa[ab.name]=ab}var ad=X.getLength();X.addItem({id:ad,hidden:false,property:U,displayName:U,previousValue:null,value:null,type:"userDefined"});var ac=X.getRowById(ad);V.setActiveCell(ac,V.getColumnIndex("value"));V.editActiveCell()})}else{if(W.hidden===true){X.updateItem(W.id,t.extend(W,{hidden:false,previousValue:null,value:null}));var Y=X.getRowById(W.id);V.setActiveCell(Y,V.getColumnIndex("value"));V.editActiveCell()}else{h.showOkDialog({headerText:"Property Exists",dialogContent:"A property with this name already exists."});var Y=X.getRowById(W.id);V.setSelectedRows([Y]);V.scrollRowIntoView(Y)}}}else{h.showOkDialog({headerText:"Property Name",dialogContent:"Property name must be specified."})}L.modal("hide")};var T=function(){L.modal("hide")};N.on("keydown",function(V){var U=V.keyCode?V.keyCode:V.which;if(U===t.ui.keyCode.ENTER){R();V.stopImmediatePropagation();V.preventDefault()}});L.on("click","div.new-property-ok",R).on("click","div.new-property-cancel",T);var Q=t('<div class="add-property"></div>').appendTo(O);t('<button class="button fa fa-plus"></button>').on("click",function(){p(S);N.val("");L.modal("show");N.focus()}).appendTo(Q)}t('<div class="clear"></div>').appendTo(O);m(S,K)}})},loadProperties:function(K,L,M){return this.each(function(){var N=t(this).find("div.property-table");D(N,K,L,M)})},saveRow:function(){return this.each(function(){var K=t(this).find("div.property-table");p(K)})},resetTableSize:function(){return this.each(function(){var L=t(this).find("div.property-table");var K=L.data("gridInstance");if(C.isDefinedAndNotNull(K)){K.resizeCanvas()}})},cancelEdit:function(){return this.each(function(){var M=t(this).find("div.property-table");var L=M.data("gridInstance");if(C.isDefinedAndNotNull(L)){var K=L.getEditController();K.cancelCurrentEdit()}})},destroy:function(){return this.each(function(){var L=t(this);var K=L.data("options");if(C.isDefinedAndNotNull(K)){y(L);if(C.isDefinedAndNotNull(K.dialogContainer)){t("#new-property-dialog").modal("hide");t(K.dialogContainer).children("div.new-inline-controller-service-dialog").remove()}}})},clear:function(){return this.each(function(){y(t(this))})},isSaveRequired:function(){var K=false;this.each(function(){var N=t(this).find("div.property-table");var L=N.data("gridInstance");var M=L.getData();t.each(M.getItems(),function(){if(this.value!==this.previousValue){K=true;return false}});return false});return K},marshalProperties:function(){var K={};this.each(function(){var N=t(this).find("div.property-table");var L=N.data("gridInstance");var M=L.getData();t.each(M.getItems(),function(){if(this.hidden===true){K[this.property]=null}else{if(this.value!==this.previousValue){K[this.property]=this.value}}});return false});return K},setGroupId:function(K){return this.each(function(){E=K})}};t.fn.propertytable=function(K){if(u[K]){return u[K].apply(this,Array.prototype.slice.call(arguments,1))}else{return u.init.apply(this,arguments)}}}));