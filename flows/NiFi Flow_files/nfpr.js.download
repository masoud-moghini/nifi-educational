(function(a,b){if(typeof define==="function"&&define.amd){define(["jquery","CodeMirror"],function(d,c){return(nf.nfpr=b(d,c))})}else{if(typeof exports==="object"&&typeof module==="object"){module.exports=(nf.nfpr=b(require("jquery"),require("CodeMirror")))}else{nf.nfpr=b(a.$,a.CodeMirror)}}}(this,function(c,n){var j=function(t){var s=c("<div></div>");c('<div class="el-name el-section"></div>').text(t.name).appendTo(s);if(typeof t.description!=="undefined"&&t.description!==null){c('<div class="el-section"></div>').text(t.description).appendTo(s)}return s};var r=/^[a-zA-Z0-9-_. ]+/;var d=[];var o=new RegExp("^$");var g={};var a=false;var f="parameter";var q="invalid";var e=function(t,s){var u=0;t.eatWhile(function(v){if(v==="#"){u++;return true}return false});if(u%2===0){return null}if(u>1){t.backUp(1);return null}if(t.peek()==="{"){t.next();s.push({context:f});t.eatSpace();return"bracket"}else{return null}};var b=null;var p=null;var m=[];var k=function(s,t){h();b=c(t).qtip("api");p=setTimeout(function(){b.show()},500)};var h=function(){if(p!==null){clearInterval(p);p=null}if(b!==null){b.hide()}};var i=function(){if(p!==null){clearInterval(p);p=null}b=null;c.each(m,function(s,t){t.destroy(true)});m=[]};var l=function(u,t,w){var v=c("<div></div>").text(w.text);var s=c(u).qtip({content:j(g[w.text]),style:{classes:"nifi-tooltip nf-tooltip",tip:false,width:350},show:{event:false,effect:false},hide:{event:false,effect:false},position:{at:"bottom right",my:"bottom left",adjust:{x:20}}}).append(v);m.push(s.qtip("api"))};return{enableParameters:function(){d=[];o=new RegExp("^$");g={};a=true},setParameters:function(s){s.forEach(function(t){d.push(t.name);g[t.name]=t});o=new RegExp("^(("+d.join(")|(")+"))$")},disableParameters:function(){d=[];o=new RegExp("^$");g={};a=false},color:function(){var s=function(u){var t=u;return{copy:function(){var w=[];for(var v=0;v<t.length;v++){w.push({context:t[v].context})}return w},get:function(){if(t.length===0){return{context:null}}else{return t[t.length-1]}},push:function(v){return t.push(v)},pop:function(){return t.pop()}}};return{startState:function(){return s([])},copyState:function(t){return s(t.copy())},token:function(x,u){if(x.eatSpace()){return null}if(x.eol()){return null}var w=x.peek();var v=u.get();if(v.context===q){x.skipToEnd();return null}if(v.context===f){var t=x.match(r,false);if(t!==null&&t.length===1){x.match(r);if(o.test(t)){return"builtin"}else{return"string"}}else{if(w==="}"){x.next();if(typeof u.pop()==="undefined"){return null}else{return"bracket"}}else{x.skipToEnd();v.context=q;return null}}}if(w==="#"&&a){return e(x,u)}if(w==="}"){x.next();if(typeof u.pop()==="undefined"){return null}else{return"bracket"}}x.next();return null}}},suggest:function(z){var D=z.getCursor();var u=z.getTokenAt(D);var v=false;var s=u.state.get();var x=function(E){return E===f};var t=s.context;if(!x(t)){return null}var C=u.string.toLowerCase();var y=c.trim(C);if(y==="#{"){v=true;u.start+=C.length}var A=function(E){var F=[];c.each(E,function(G,H){if(c.inArray(H,F)===-1){if(v||H.toLowerCase().indexOf(C)===0){F.push({text:H,render:l})}}});return F};var w=A(d);w=w.sort(function(G,E){var H=G.text.toLowerCase();var F=E.text.toLowerCase();return H===F?0:H>F?1:-1});var B={list:w,from:{line:D.line,ch:u.start},to:{line:D.line,ch:u.end}};n.on(B,"select",k);n.on(B,"close",i);return B},getLanguageId:function(){return"nfpr"},supportsEl:function(){return false},supportsParameterReference:function(){return a}}}));